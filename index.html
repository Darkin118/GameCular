<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GameCular ì„¤ë¬¸ ê¸°ë°˜ ê²Œì„ ì¶”ì²œ</title>
<style>
body {
    font-family: 'Noto Sans KR', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    margin: 0;
    padding: 20px;
}

.container{
    background-color: white;
    padding: 2.5rem;
    border-radius: 20px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.2);
    width: 100%;
    max-width: 420px;
    text-align: center;
}

h1 {
    color: #667eea;
    margin-bottom: 1.5rem;
    font-size: 1.8rem;
}

fieldset {
    border: none;
    margin-bottom: 20px;
    padding: 15px;
    background: #f8f9fa;
    border-radius: 10px;
    text-align: left;
}

legend {
    font-weight: 600;
    color: #333;
    padding: 0 10px;
    font-size: 0.95rem;
}

.radio-group {
    display: flex;
    justify-content: space-between;
    margin-top: 10px;
}

.radio-group label {
    flex: 1;
    text-align: center;
    cursor: pointer;
    padding: 8px;
    border-radius: 5px;
    transition: background-color 0.2s;
}

.radio-group label:hover {
    background-color: #e9ecef;
}

.radio-group input[type="radio"] {
    cursor: pointer;
}

#recommend-btn {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border: none;
    padding: 15px 40px;
    font-size: 1.1rem;
    font-weight: 600;
    border-radius: 25px;
    cursor: pointer;
    transition: transform 0.2s, box-shadow 0.2s;
    margin-top: 20px;
    width: 100%;
}

#recommend-btn:hover:not(:disabled) {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
}

#recommend-btn:disabled {
    opacity: 0.6;
    cursor: not-allowed;
}

#status-message {
    margin: 20px 0;
    padding: 15px;
    border-radius: 10px;
    font-size: 0.9rem;
}

#status-message.info {
    background-color: #e3f2fd;
    color: #1976d2;
}

#status-message.error {
    background-color: #ffebee;
    color: #c62828;
}

#result-area {
    padding: 25px;
    border: 2px solid #667eea;
    border-radius: 15px;
    background: linear-gradient(135deg, #f8f9ff 0%, #f0f2ff 100%);
    margin-top: 25px;
}

.game-thumbnail {
    margin-bottom: 15px;
}

.game-thumbnail img {
    width: 100%;
    max-width: 300px;
    height: 180px;
    object-fit: cover;
    border-radius: 12px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.1);
}

.game-info h2 {
    color: #667eea;
    margin: 15px 0 10px 0;
    font-size: 1.4rem;
}

.game-info p {
    margin: 8px 0;
    color: #555;
}

.rating {
    display: inline-block;
    background-color: #ffc107;
    color: #000;
    padding: 5px 12px;
    border-radius: 15px;
    font-weight: 600;
    margin: 10px 0;
}

.platforms {
    display: flex;
    gap: 8px;
    justify-content: center;
    flex-wrap: wrap;
    margin-top: 10px;
}

.platform-tag {
    background-color: #e9ecef;
    padding: 4px 10px;
    border-radius: 12px;
    font-size: 0.8rem;
    color: #495057;
}

.hidden {
    display: none;
}

.loading {
    display: inline-block;
    width: 20px;
    height: 20px;
    border: 3px solid rgba(255,255,255,.3);
    border-radius: 50%;
    border-top-color: white;
    animation: spin 1s ease-in-out infinite;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}

small {
    display: block;
    margin-top: 10px;
    font-size: 0.75rem;
    color: #999;
}
</style>
</head>
<body>
    <div class="container">
        <h1>ğŸ® GameCular<br>ì„¤ë¬¸ ê¸°ë°˜ ê²Œì„ ì¶”ì²œ</h1>

        <form id="survey-form">
            <fieldset>
                <legend>1. ë¹ ë¥¸ ì•¡ì…˜ê³¼ ìŠ¤ë¦´ì„ ì¦ê¸°ê³  ì‹¶ë‹¤</legend>
                <div class="radio-group">
                    <label><input type="radio" name="q1" value="1"> 1</label>
                    <label><input type="radio" name="q1" value="2"> 2</label>
                    <label><input type="radio" name="q1" value="3" checked> 3</label>
                    <label><input type="radio" name="q1" value="4"> 4</label>
                    <label><input type="radio" name="q1" value="5"> 5</label>
                </div>
            </fieldset>

            <fieldset>
                <legend>2. íƒí—˜í•˜ê³  ìƒˆë¡œìš´ ì„¸ê³„ë¥¼ ê²½í—˜í•˜ê³  ì‹¶ë‹¤</legend>
                <div class="radio-group">
                    <label><input type="radio" name="q2" value="1"> 1</label>
                    <label><input type="radio" name="q2" value="2"> 2</label>
                    <label><input type="radio" name="q2" value="3" checked> 3</label>
                    <label><input type="radio" name="q2" value="4"> 4</label>
                    <label><input type="radio" name="q2" value="5"> 5</label>
                </div>
            </fieldset>

            <fieldset>
                <legend>3. ê¹Šì€ ìŠ¤í† ë¦¬ì™€ ì „ëµì  ì‚¬ê³ ë¥¼ ì›í•œë‹¤</legend>
                <div class="radio-group">
                    <label><input type="radio" name="q3" value="1"> 1</label>
                    <label><input type="radio" name="q3" value="2"> 2</label>
                    <label><input type="radio" name="q3" value="3" checked> 3</label>
                    <label><input type="radio" name="q3" value="4"> 4</label>
                    <label><input type="radio" name="q3" value="5"> 5</label>
                </div>
            </fieldset>

            <fieldset>
                <legend>4. í¸ì•ˆí•˜ê²Œ ì‰¬ë©´ì„œ ê°€ë³ê²Œ ì¦ê¸°ê³  ì‹¶ë‹¤</legend>
                <div class="radio-group">
                    <label><input type="radio" name="q4" value="1"> 1</label>
                    <label><input type="radio" name="q4" value="2"> 2</label>
                    <label><input type="radio" name="q4" value="3" checked> 3</label>
                    <label><input type="radio" name="q4" value="4"> 4</label>
                    <label><input type="radio" name="q4" value="5"> 5</label>
                </div>
            </fieldset>

            <button type="button" id="recommend-btn">ì¶”ì²œ ë°›ê¸°</button>
        </form>

        <div id="status-message" class="info">
            ê²Œì„ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
        </div>
        <div id="result-area" class="hidden"></div>
        
        <small>â€» RAWG APIë¥¼ í™œìš©í•œ ì‹¤ì‹œê°„ ê²Œì„ ì¶”ì²œ ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤</small>
    </div>

    <script>
let ALL_GAMES = [];
let isLoading = true;
const API_KEY = "d6756424932b4fe2b4092a1b64e6204f";
const RAWG_URL = `https://api.rawg.io/api/games?key=${API_KEY}&page_size=40&ordering=-rating`;

const MOOD_TO_GENRES = {
    action: ["Action", "Shooter", "Fighting"],
    adventure: ["Adventure", "Platformer"],
    story: ["RPG", "Strategy"],
    relax: ["Simulation", "Casual", "Puzzle", "Family"]
};

const GENRE_TRANSLATIONS = {
    "Action": "ì•¡ì…˜",
    "Indie": "ì¸ë””",
    "Adventure": "ì–´ë“œë²¤ì²˜",
    "RPG": "ë¡¤í”Œë ˆì‰",
    "Strategy": "ì „ëµ",
    "Shooter": "ìŠˆíŒ…",
    "Puzzle": "í¼ì¦",
    "Simulation": "ì‹œë®¬ë ˆì´ì…˜",
    "Platformer": "í”Œë«í¼",
    "Casual": "ìºì£¼ì–¼",
    "Arcade": "ì•„ì¼€ì´ë“œ",
    "Fighting": "ê²©íˆ¬",
    "Family": "ê°€ì¡±",
    "Racing": "ë ˆì´ì‹±",
    "Sports": "ìŠ¤í¬ì¸ "
};

const PLATFORM_ICONS = {
    "PC": "ğŸ’»",
    "PlayStation": "ğŸ®",
    "Xbox": "ğŸ®",
    "Nintendo": "ğŸ®",
    "iOS": "ğŸ“±",
    "Android": "ğŸ“±",
    "Mac": "ğŸ’»"
};

function updateStatus(message, type = 'info') {
    const statusEl = document.getElementById('status-message');
    statusEl.textContent = message;
    statusEl.className = type;
}

function loadGames() {
    updateStatus('ê²Œì„ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...', 'info');
    
    fetch(RAWG_URL)
        .then(res => {
            if (!res.ok) throw new Error('API ì‘ë‹µ ì˜¤ë¥˜');
            return res.json();
        })
        .then(data => {
            ALL_GAMES = data.results || [];
            isLoading = false;
            updateStatus('ì„¤ë¬¸ì„ ì™„ë£Œí•˜ê³  ì¶”ì²œ ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”', 'info');
            document.getElementById('recommend-btn').disabled = false;
            console.log(`${ALL_GAMES.length}ê°œì˜ ê²Œì„ ë¡œë”© ì™„ë£Œ`);
        })
        .catch(err => {
            console.error("API ë¡œë”© ì‹¤íŒ¨:", err);
            isLoading = false;
            updateStatus('ê²Œì„ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.', 'error');
            document.getElementById('recommend-btn').disabled = true;
        });
}

function calculateMood() {
    const scores = {
        action: parseInt(document.querySelector('input[name="q1"]:checked')?.value || 0),
        adventure: parseInt(document.querySelector('input[name="q2"]:checked')?.value || 0),
        story: parseInt(document.querySelector('input[name="q3"]:checked')?.value || 0),
        relax: parseInt(document.querySelector('input[name="q4"]:checked')?.value || 0)
    };

    let maxMood = "action";
    let maxScore = scores.action;
    
    for (let mood in scores) {
        if (scores[mood] > maxScore) {
            maxMood = mood;
            maxScore = scores[mood];
        }
    }
    
    console.log("ì„¤ë¬¸ ì ìˆ˜:", scores, "â†’ ì„ íƒëœ mood:", maxMood);
    return maxMood;
}

function recommendGame() {
    if (isLoading || ALL_GAMES.length === 0) {
        updateStatus('ê²Œì„ ë°ì´í„°ë¥¼ ì•„ì§ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤. ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.', 'error');
        return;
    }

    const mood = calculateMood();
    const targetGenres = MOOD_TO_GENRES[mood];
    
    updateStatus('ê²Œì„ì„ ì¶”ì²œí•˜ëŠ” ì¤‘...', 'info');

    const filteredGames = ALL_GAMES
        .filter(g => Array.isArray(g.genres) && g.genres.length > 0)
        .filter(g => g.genres.some(gg => 
            targetGenres.some(tg => tg.toLowerCase() === gg.name.toLowerCase())
        ))
        .filter(g => g.rating >= 3.5);

    console.log(`${targetGenres.join(', ')} ì¥ë¥´ì—ì„œ ${filteredGames.length}ê°œ ê²Œì„ ë°œê²¬`);

    if (filteredGames.length === 0) {
        const translatedGenres = targetGenres.map(g => GENRE_TRANSLATIONS[g] || g).join(", ");
        updateStatus(`ì£„ì†¡í•©ë‹ˆë‹¤. [${translatedGenres}] ì¥ë¥´ì˜ ê³ í‰ì  ê²Œì„ì„ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.`, 'error');
        document.getElementById('result-area').classList.add('hidden');
        return;
    }

    const selectedGame = filteredGames[Math.floor(Math.random() * filteredGames.length)];
    displayRecommendation(selectedGame, targetGenres);
}

function displayRecommendation(game, genres) {
    const resultArea = document.getElementById('result-area');
    const title = game.name;
    const genreStr = Array.isArray(game.genres) 
        ? game.genres.map(g => GENRE_TRANSLATIONS[g.name] || g.name).join(', ') 
        : 'ì¥ë¥´ ì •ë³´ ì—†ìŒ';
    
    const imgUrl = game.background_image || 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="300" height="180"%3E%3Crect fill="%23ddd" width="300" height="180"/%3E%3Ctext x="50%25" y="50%25" text-anchor="middle" dy=".3em" fill="%23999"%3Eì´ë¯¸ì§€ ì—†ìŒ%3C/text%3E%3C/svg%3E';
    
    const rating = game.rating ? game.rating.toFixed(1) : 'N/A';
    
    const platforms = game.platforms 
        ? game.platforms.slice(0, 4).map(p => {
            const platformName = p.platform.name;
            for (let key in PLATFORM_ICONS) {
                if (platformName.includes(key)) {
                    return `<span class="platform-tag">${PLATFORM_ICONS[key]} ${platformName}</span>`;
                }
            }
            return `<span class="platform-tag">${platformName}</span>`;
        }).join('')
        : '';

    resultArea.classList.remove('hidden');
    resultArea.innerHTML = `
        <div class="game-thumbnail">
            <img src="${imgUrl}" alt="${title}" onerror="this.style.display='none'">
        </div>
        <div class="game-info">
            <h2>ğŸ‰ ${title}</h2>
            <div class="rating">â­ ${rating} / 5.0</div>
            <p><strong>ì¥ë¥´:</strong> ${genreStr}</p>
            ${platforms ? `<div class="platforms">${platforms}</div>` : ''}
            <p style="color:#666; font-size:0.9rem; margin-top:15px;">
                ${game.released ? `ì¶œì‹œì¼: ${game.released}` : ''}
            </p>
        </div>
    `;

    const translatedGenres = genres.map(g => GENRE_TRANSLATIONS[g] || g).join(", ");
    updateStatus(`[${translatedGenres}] ì¥ë¥´ì˜ ê²Œì„ì„ ì¶”ì²œí–ˆìŠµë‹ˆë‹¤! ğŸ®`, 'info');
    
    resultArea.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
}

document.addEventListener('DOMContentLoaded', () => {
    loadGames();
    document.getElementById('recommend-btn').addEventListener('click', recommendGame);
});
    </script>
</body>
</html>